% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/DE.R
\name{shinyDE}
\alias{shinyDE}
\title{Create an interactive Shiny app for differential expression results exploration}
\usage{
shinyDE(
  mat,
  res,
  metadata = NULL,
  annot.by = NULL,
  sig.col = NULL,
  lfc.col = "log2FoldChange",
  abundance.col = "baseMean",
  h.id = "ht1",
  genesets = NULL,
  swap.rownames = NULL,
  height = 800
)
}
\arguments{
\item{mat}{A numeric matrix of expression values (e.g., normalized counts, VST-transformed counts, log-CPM).
Rows are features (genes) and columns are samples. Required.}

\item{res}{A data frame or named list of data frames containing differential expression results.
Each data frame must contain columns for significance, fold change, and abundance (see sig.col, lfc.col, and abundance.col parameters).
If a named list is provided, users will be able to choose between results in the app. Required.}

\item{metadata}{A data frame containing sample metadata. Rows should correspond to columns in \code{mat}.
If provided, can be used for heatmap annotations and sample filtering. Optional.}

\item{annot.by}{A string or character vector containing the names of metadata columns to be used as heatmap annotations.
Only used if \code{metadata} is provided. Optional.}

\item{sig.col}{String specifying the column name in \code{res} containing significance values (e.g., "padj", "FDR", "svalue").
Will be auto-detected from common column names if not provided.}

\item{lfc.col}{String specifying the column name in \code{res} containing log2 fold change values (e.g., "log2FoldChange", "logFC").
Defaults to "log2FoldChange".}

\item{abundance.col}{String specifying the column name in \code{res} containing abundance/expression values (e.g., "baseMean", "AveExpr").
Defaults to "baseMean".}

\item{h.id}{String indicating unique ID for interactive heatmaps.
Required if multiple apps are run within the same Rmd file. Defaults to "ht1".}

\item{genesets}{Optional named list containing genesets that can be interactively highlighted on the plots.
The elements of the list should each be a geneset with gene identifiers matching those used as rownames in \code{mat} and \code{res}.}

\item{swap.rownames}{String. The column name in \code{res} used to identify features instead of rownames.
Note if this column contains duplicates (e.g. gene symbols), they will be made unique via the addition of ".1", ".2", etc.}

\item{height}{Number indicating height of app in pixels. Defaults to 800.}
}
\value{
A Shiny app containing interconnected InteractiveComplexHeatmap, MAplot, and volcano plots along with full DE results.
}
\description{
This shiny app is composed of three tabs - an interactive heatmap, MA and volcano plots, and a table of full
differential expression results. The interactive heatmap will generate a sub-heatmap for selected rows/columns.
This function accepts DE results from any analysis tool (DESeq2, edgeR, limma, etc.) and allows customization
of column names for significance, fold change, and abundance metrics.
}
\details{
Gene labels can be added to the MAplot and volcano plot by clicking a point. The labels can also be dragged around,
though adding labels will reset the positions, so it's recommended to add all labels prior to re-positioning them.

Note that significance values of 0 will always be pushed above the y-limit of the volcano plot,
as they are infinite values after log transformation.
}
\examples{
\dontrun{
# Example with DESeq2 results
library(DESeq2)
dds <- DESeq(dds)
res <- results(dds)
mat <- assay(vst(dds))
shinyDE(mat, res = as.data.frame(res), metadata = colData(dds))

# Example with edgeR results
library(edgeR)
fit <- glmQLFit(y, design)
qlf <- glmQLFTest(fit)
res <- topTags(qlf, n = Inf)$table
shinyDE(mat, res = res, lfc.col = "logFC", abundance.col = "logCPM", sig.col = "FDR")
}
}
\author{
Jared Andrews, based on code by Zuguang Gu.
}
